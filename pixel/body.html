<style type="text/css">
  .embeddedServiceHelpButton .helpButton .uiButton {
    background-color: #005290;
    font-family: "Arial", sans-serif;
  }
  .embeddedServiceHelpButton .helpButton .uiButton:focus {
    outline: 1px solid #005290;
  }
</style>

<script type="text/javascript">
  let email = "";
  let firstName = "";
  let company = "";
  let lastName = "";
  let auth;
  __RENDER_8_SESSION__.sessionPromise.then((value) => {
    auth = value.response.namespaces.profile.isAuthenticated.value;

    if (auth === "false") {
      var initESW = function (gslbBaseURL) {
        embedded_svc.settings.displayHelpButton = true;
        embedded_svc.settings.displayHelpButton = true;
        if ("{{settings.language}}" != "") {
          embedded_svc.settings.language = window.decodeURIComponent(
            "{{settings.language}}"
          );
        }
        if ("{{settings.defaultMinimizedText}}" != "") {
          //(Toma como valor predeterminado Sesi贸n de chat con un experto)
          embedded_svc.settings.defaultMinimizedText =
            window.decodeURIComponent("{{settings.defaultMinimizedText}}");
        }
        if ("{{settings.disabledMinimizedText}}" != "") {
          //(Toma como valor predeterminado Agente sin conexi贸n)
          embedded_svc.settings.disabledMinimizedText =
            window.decodeURIComponent("{{settings.disabledMinimizedText}}");
        }
        if ("{{settings.loadingText}}" != "") {
          //(Toma como valor predeterminado Cargando)
          embedded_svc.settings.loadingText = window.decodeURIComponent(
            "{{settings.loadingText}}"
          );
        }

        var enabledFeatures = window.decodeURIComponent(
          "{{settings.enabledFeatures}}"
        );
        embedded_svc.settings.enabledFeatures = JSON.parse(enabledFeatures);
        embedded_svc.settings.entryFeature = "{{settings.entryFeature}}";

        embedded_svc.init(
          window.decodeURIComponent("{{settings.baseCoreURL}}"),
          window.decodeURIComponent("{{settings.communityEndpointURL}}"),
          gslbBaseURL,
          "{{settings.organizationId}}",
          "{{settings.loggedAccountName}}",
          {
            baseLiveAgentContentURL:
              "https://c.la5-c1cs-ia5.salesforceliveagent.com/content",
            deploymentId: "{{settings.deploymentId}}",
            buttonId: "{{settings.buttonId}}",
            baseLiveAgentURL:
              "https://d.la5-c1cs-ia5.salesforceliveagent.com/chat",
            eswLiveAgentDevName: "{{settings.eswLiveAgentDevName}}",
            isOfflineSupportEnabled: "{{settings.isOfflineSupportEnabled}}",
            isOfflineSupportEnabled: false,
          }
        );
      };

      if (!window.embedded_svc) {
        var s = document.createElement("script");
        s.setAttribute(
          "src",
          "https://engfast--chatboten.my.salesforce.com/embeddedservice/5.0/esw.min.js"
        );
        s.onload = function () {
          initESW(null);
        };
        document.body.appendChild(s);
      } else {
        initESW("https://service.force.com");
      }

      // For logged-in user
    } else {
      email = value.response.namespaces.profile.email.value;
      firstName = value.response.namespaces.profile.firstName.value;
      lastName = value.response.namespaces.profile.lastName.value;

      var callback = function () {
        // Handler when the DOM is fully loaded
        var initESW = function (gslbBaseURL) {
          embedded_svc.settings.displayHelpButton = true;
          if ("{{settings.language}}" != "") {
            embedded_svc.settings.language = window.decodeURIComponent(
              "{{settings.language}}"
            );
          }
          if ("{{settings.defaultMinimizedText}}" != "") {
            //(Toma como valor predeterminado Sesi贸n de chat con un experto)
            embedded_svc.settings.defaultMinimizedText =
              window.decodeURIComponent("{{settings.defaultMinimizedText}}");
          }
          if ("{{settings.disabledMinimizedText}}" != "") {
            //(Toma como valor predeterminado Agente sin conexi贸n)
            embedded_svc.settings.disabledMinimizedText =
              window.decodeURIComponent("{{settings.disabledMinimizedText}}");
          }
          if ("{{settings.loadingText}}" != "") {
            //(Toma como valor predeterminado Cargando)
            embedded_svc.settings.loadingText = window.decodeURIComponent(
              "{{settings.loadingText}}"
            );
          }

          var enabledFeatures = window.decodeURIComponent(
            "{{settings.enabledFeatures}}"
          );
          embedded_svc.settings.enabledFeatures = JSON.parse(enabledFeatures);
          embedded_svc.settings.entryFeature = "{{settings.entryFeature}}";

          embedded_svc.settings.prepopulatedPrechatFields = {
            FirstName: firstName,
            LastName: lastName,
            Company: "",
            Email: email,
          };
          embedded_svc.init(
            window.decodeURIComponent("{{settings.baseCoreURL}}"),
            window.decodeURIComponent("{{settings.communityEndpointURL}}"),
            gslbBaseURL,
            "{{settings.organizationId}}",
            "{{settings.loggedAccountName}}",
            {
              baseLiveAgentContentURL:
                "https://c.la5-c1cs-ia5.salesforceliveagent.com/content",
              deploymentId: "{{settings.deploymentId}}",
              buttonId: "{{settings.buttonId}}",
              baseLiveAgentURL:
                "https://d.la5-c1cs-ia5.salesforceliveagent.com/chat",
              eswLiveAgentDevName: "{{settings.eswLiveAgentDevName}}",
              isOfflineSupportEnabled: "{{settings.isOfflineSupportEnabled}}",
            }
          );
        };

        if (!window.embedded_svc) {
          var s = document.createElement("script");
          s.setAttribute(
            "src",
            "https://engfast--chatboten.my.salesforce.com/embeddedservice/5.0/esw.min.js"
          );
          s.onload = function () {
            initESW(null);
          };
          document.body.appendChild(s);
        } else {
          initESW("https://service.force.com");
        }
      };
    }
    if (
      document.readyState === "complete" ||
      (document.readyState !== "loading" && !document.documentElement.doScroll)
    ) {
      callback();
    } else {
      document.addEventListener("DOMContentLoaded", callback);
    }
  });
</script>
